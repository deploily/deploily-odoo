<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="cibepay_form">
        <div>
            <input type="hidden" name="data_set" t-att-data-action-url="tx_url" data-remove-me="" />
            <input type="hidden" name="mdOrder" t-att-value="mdOrder" />
        </div>
    </template>
    <template id="cibepay_redirect_form">
        <form t-att-action="api_url" method="get">
            <input type="hidden" name="mdOrder" t-att-value="mdOrder" />
            <input type="hidden" name="language" value="fr" />
            <!-- <div class="alert alert-danger" role="alert">
                Payment redirection failed.
            </div> -->
        </form>

    </template>


    <template id="cibepay_payment_method_form" inherit_id="payment.method_form">
        <xpath expr='//div[@name="o_payment_tokenize_container"]' position='replace'>
            <div t-if="mode == 'payment'
            and pm_sudo.code=='cibepay'"
                name="o_term_conditions"
                class="o-checkbox form-check m-0"
            >
                <label>
                    <input name="o_payment_tokenize_checkbox"
                        type="checkbox"
                        class="form-check-input"
                    />
                    <span> J'accepte les </span>
                    <a t-att-href="website.terms_conditions_page.url" target="_blank"> conditions d'utilisation </a>
                </label>
            </div>
        </xpath>
        <xpath expr='//input[@name="o_payment_tokenize_checkbox"]' position='replace'>
            <input name="o_payment_tokenize_checkbox"
                type="checkbox"
                class="form-check-input"
                id="payment_terms_conditions_checkbox"
                onchange="updateSubmit_signup();"
            />
        </xpath>
        <xpath expr='//div[@class="o-checkbox form-check m-0"]' position='inside'>
            <t t-call="deploily_signup.recaptcha">
                <t t-set="callback_name">updateSubmit_signup</t>
            </t>
        </xpath>
        <!-- <xpath expr='//button[@id="o_payment_form_pay"]' position='inside'>
            <t t-set="providers" t-value="[acq.provider for acq in acquirers if acq.state in ['test', 'enabled']]" />
            <t t-if="'cibepay' in providers">
                <img src="/payment_cib_ipay/static/src/image/logo_cib.png" height="47" alt="logo CIB" />
            </t>
        </xpath> -->
    </template>
    <template id="cibepay_submit_button" inherit_id="payment.submit_button">
        <xpath expr='//button[@name="o_payment_submit_button"]' position='replace'>

            <button name="o_payment_submit_button"
                type="submit"
                class="btn btn-primary w-100 w-md-auto ms-auto px-5"
                disabled="true"
            > Pay now <img id="cib_logo" class="cib-hidden" src="/deploily_epayment/static/src/images/logo_cib.png" height="37" alt="logo CIB" />
            </button>

        </xpath>
    </template>

    <template id="payment_cibepay_sale_confirmation_sendmail" name="Products">
        <t t-call="website.layout">
            <t t-set="additional_title"> Confirmation de mail </t>
            <div class="text-left p-4">
                <h5>
                    <span> Un mail a été transmis à l'adresse suivant : </span>
                    <em t-esc="mail_address" />
                </h5>
            </div>
        </t>
    </template>


    <!-- 
    <template id="payment_cibepay_assets_frontend" inherit_id="web.assets_frontend">
        <xpath expr="link[last()]" position="after">
            <link rel="stylesheet" type="text/css" href="/payment_cib_ipay/static/src/css/cibepay_styles.css" />
        </xpath>
        <xpath expr="script[last()]" position="after">
            <script type="text/javascript" src="https://www.google.com/recaptcha/api.js"></script>
            <script type="text/javascript" src="/payment_cib_ipay/static/src/js/cibepay_scripts.js"></script>
        </xpath>
    </template>

    <template id="payment_cibepay_sale_confirmation_status" inherit_id="website_sale.payment_confirmation_status">
        <xpath expr='//div/div' position='after'>
            <div t-if="payment_tx_id.acquirer_id.provider == 'cibepay'" class="text-center  p-3">
                <img src="/payment_cib_ipay/static/src/image/logo_cib.png" height="47" alt="logo CIB" />
                <img src="/payment_cib_ipay/static/src/image/satim_3020.png" alt="numero vert SATIM" />
            </div>
        </xpath>
        <xpath expr='//div[@class="card-header"]' position='inside'>
            <div t-if="payment_tx_id.acquirer_id.provider == 'cibepay'" class="text-left p-4">
                <t t-if="payment_tx_id.state == 'done'">
                    <h3>
                        <em t-esc="payment_tx_id.cibepay_resp_code_desc" />
                    </h3>
                    <h5>
                        <span> Identifiant de la transaction : </span>
                        <em t-field="payment_tx_id.cibepay_mdorder" />
                    </h5>
                    <h5>
                        <span> Numéro d'autorisation : </span>
                        <em t-field="payment_tx_id.cibepay_approval_code" />
                    </h5>
                    <h5>
                        <span> Date et heure de la transaction : </span>
                        <em t-field="payment_tx_id.date" />
                    </h5>
                </t>
            </div>
        </xpath>
    </template>

    <template id="payment_cibepay_sale_confirmation" inherit_id="website_sale.confirmation">
        <xpath expr='//a[@href="/shop/print"]' position='after'>
            <t t-if="payment_tx_id.acquirer_id.provider == 'cibepay'">
                <a role="button" class="btn btn-primary d-none d-md-inline-block" href="/shop/print" target="_blank" aria-label="Sen by mail" title="Download" download="">
                    <i class="fa fa-print"></i>
                    <span> Télécharger </span>
                </a>
                <button type="button" class="btn btn-primary d-none d-md-inline-block" data-toggle="modal" data-target="#input_email_box">
                    <i class="fa fa-envelope"></i>
                    <span> Envoyer par mail </span>
                </button>

                <div id="input_email_box" class="modal fade" tabindex="-1" role="dialog">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title"> Envoyer par mail </h5>
                            </div>
                            <div class="modal-body">
                                <form role="form" method="GET" action="/shop/cibepay/sendbymail" target="_blank">
                                    <div class="form-group">
                                        <label for="receiver_mail"> Email de destination </label>
                                        <input class="form-control" id="receiver_mail" name="receiver_mail" aria-describedby="receiver_mail" placeholder="Email de destination" required="" />
                                    </div>
                                    <div class="form-group">
                                        <button type="submit" class="btn btn-primary d-none d-md-inline-block">
                                            <i class="fa fa-envelope"></i>
                                            <span> Envoyer </span>
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </xpath>
    </template>

    <template id="payment_cibepay_sale_confirmation_sendmail" name="Products">
        <t t-call="website.layout">
            <t t-set="additional_title"> Confirmation de mail </t>
            <div class="text-left p-4">
                <h5>
                    <span> Un mail a été transmis à l'adresse suivant : </span>
                    <em t-esc="mail_address" />
                </h5>
            </div>
        </t>
    </template>


    <template id="payment_cibepay_refund" name="Refund">
        <t t-call="website.layout">
            <t t-set="additional_title"> Remboursement </t>
            <form action="/payment/cibepay/refund/status" method="post" class="card col-md-4 col-md-offset-4 m-4">
                <div class="form-group">
                    <label for="order_id"> Identifiant de la transaction </label>
                    <input class="form-control" id="order_id" name="order_id" aria-describedby="OrderId" placeholder="Identifiant de la transaction" required="" />
                </div>
                <div class="form-group">
                    <label for="amount"> Montant à rembourser </label>
                    <input type="number" class="form-control" id="amount" name="amount" placeholder="Montant" data-bind="value:amount" required="" />
                </div>
                <button type="submit" class="btn btn-primary a-submit mb-4" aria-label="Do refund" title="Do refund">
                    <span class="fa fa-shopping-cart" />
                    <span> Rembourser le montant </span>
                </button>
            </form>
        </t>
    </template>


    <template id="payment_cibepay_refund_status" name="Refund">
        <t t-call="website.layout">
            <t t-set="additional_title"> Status du remboursement </t>
            <div class="text-left p-4">
                <h5>
                    <span> Status de votre remboursement : </span>
                    <em t-esc="refund_status" /> ( <em t-esc="refund_response_code" /> ) </h5>
            </div>
        </t>
    </template> -->

</odoo>